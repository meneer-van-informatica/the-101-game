export default { async fetch(request, env) { const ORIGIN = 'https://meneer-van-informatica.github.io'; // jouw Pages origin const cors = { 'Access-Control-Allow-Origin': ORIGIN, 'Vary': 'Origin', 'Access-Control-Allow-Methods': 'POST,OPTIONS', 'Access-Control-Allow-Headers': 'Content-Type', 'Access-Control-Max-Age': '86400' }; if (request.method === 'OPTIONS') { return new Response(null, { status: 204, headers: cors }); } if (request.method !== 'POST') { return new Response('method', { status: 405, headers: cors }); } const u = new URL(request.url); if (!u.pathname.startsWith('/api/lampen/')) { return new Response('not found', { status: 404, headers: cors }); } const action = u.pathname.endsWith('/aan') ? 'lampen_aan' : u.pathname.endsWith('/uit') ? 'lampen_uit' : null; if (!action) return new Response('bad action', { status: 400, headers: cors }); const key = env.IFTTT_KEY; if (!key) return new Response('no key', { status: 500, headers: cors }); const resp = await fetch(`https://maker.ifttt.com/trigger/${action}/with/key/${key}`, { method: 'POST' }); return new Response(resp.statusText, { status: resp.status, headers: cors }); } } 
